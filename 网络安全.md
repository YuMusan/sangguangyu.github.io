## SQL注入
SQL注入攻击是通过操作输入来修改SQL语句，用以达到执行代码对WEB服务器进行攻击的方法。post/get web表单、输入域名或页面请求的查询字符串中插入SQL命令，最终使web服务器执行恶意命令的过程。

涉及的方面：

动态查询

## url跳转漏洞
### OAuth 认证
[OAuth 2.0](http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html),对OAuth认证的详细解释。

授权码模式：

授权劫持
根据OAuth的认证流程,用户授权凭证会由服务器转发到redirect_uri对应的地址,如果攻击者伪造redirect_uri为自己的地址,然后诱导用户发送该请求,之后获取的凭证就会发送给攻击者伪造的回调地址.攻击者使用该凭证即可登录用户账号,造成授权劫持.

## CSRF

CSRF全拼为Cross Site Request Forgery，译为跨站请求伪造。
CSRF指攻击者盗用了你的身份，以你的名义发送恶意请求。
包括：以你名义发送邮件，发消息，盗取你的账号，甚至于购买商品，虚拟货币转账......
造成的问题：个人隐私泄露以及财产安全。

### CSRF的大致流程

![CSRF](https://img-blog.csdnimg.cn/20190116112233873.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNjA2OTcz,size_16,color_FFFFFF,t_70)

防止 CSRF 攻击

步骤

1. 在客户端向后端请求界面数据的时候，后端会往响应中的 cookie 中设置 csrf_token 的值
2. 在 Form 表单中添加一个隐藏的的字段，值也是 csrf_token
3. 在用户点击提交的时候，会带上这两个值向后台发起请求
4. 后端接受到请求，以会以下几件事件：
        * 从 cookie中取出 csrf_token
        * 从 表单数据中取出来隐藏的 csrf_token 的值
        * 进行对比
5. 如果比较之后两值一样，那么代表是正常的请求，如果没取到或者比较不一样，代表不是正常的请求，不执行下一步操作

登录的时候设置crsf_Token

![crsfToken](./csrfToken.png)

## SSRF
服务器端请求伪造（也称为SSRF）是一个网络安全漏洞，攻击者可以利用该漏洞诱使服务器端应用程序向攻击者选择的任意域发出HTTP请求。

在典型的SSRF示例中，攻击者可能引导服务器建立连接，使其自身，组织基础结构中的其他基于Web的服务或外部第三方系统建立连接。


## 跨站脚本XSS
跨站点脚本Cross-site scripting(也称为XSS)是一个web安全漏洞，攻击者可以利用它来破坏用户与易受攻击的应用程序之间的交互。它允许攻击者规避相同的源策略，该策略旨在将不同的网站隔离。跨站点脚本漏洞通常允许攻击者冒充受害者用户，执行用户能够执行的任何操作以及访问用户的任何数据。如果受害者用户在应用程序中具有特权访问权限，则攻击者可能完全控制应用程序的所有功能和数据。
### XSS如何工作
跨站点脚本通过操纵易受攻击的网站来工作，以便它将恶意JavaScript返回给用户。当恶意代码在受害者的浏览器中执行时，攻击者可以完全破坏他们与应用程序的交互。

![XSS](https://portswigger.net/web-security/images/cross-site-scripting.svg)

这张图中，攻击者利用有漏洞的网站，发送给用户一则伪装成消息的恶意脚本，用户点开消息就会跳转到恶意脚本，攻击者就能获取用户的敏感信息。

### XSS攻击有哪些类型
* 反射型XSS，其中恶意脚本来自当前HTTP请求。
* 存储型XSS，其中恶意脚本来自网站的数据库。
* 基于DOM的XSS，该漏洞存在于客户端代码，而不是服务端代码中。

### 反射型跨站点脚本
反射型XSS是最简单的跨站点脚本，当应用程序在HTTP请求中接收数据并将该数据以不安全的方式包含在即时响应中时，就会出现这种情况。

简单示例：
`https://insecure-website.com/status?message=All+is+well.`

`<p>Status: All is well.</p>`

该应用程序不执行数据的任何其他处理，因此攻击者可以轻松地构造如下攻击：

`https://insecure-website.com/status?message=<script>/*+Bad+stuff+here...+*/</script>`

`<p>Status: <script>/* Bad stuff here... */</script></p>`

如果用户访问由攻击者构造的URL，则攻击者的脚本将在该用户与应用程序的会话的上下文中在用户的浏览器中执行。此时，脚本可以执行用户可以访问的任何操作并检索任何数据。


另一个示例：
假设网站有搜索功能，该功能通过URL参数接收用户提供的搜索词：`https://insecure-website.com/search?term=gift`
该应用程序在对此URL的响应中回显提供的搜索词：`<p>You searched for: gift</p>`

假设应用程序不对数据进行任何其他处理，则攻击者可以进行如下攻击：
`https://insecure-website.com/status?message=<script>/*+Bad+stuff+here...+*/</script>`
该URL导致以下响应：

`<p>You searched for: <script>/* Bad stuff here... */</script></p>`

如果应用程序的另一个用户请求攻击者的URL，则攻击者提供的脚本将在受害用户的浏览器与应用程序会话的上下文中执行。

![XSS](./1.png)

![XSS](./2.png)

### 存储型跨站点脚本
当应用程序从不可信来源接收数据并将该数据以不安全的方式包含在其以后的HTTP响应中时，就会出现存储型XSS也称为持久XSS

有问题的数据可以通过HTTP请求提交给应用程序；例如，对博客帖子的评论，聊天室中的用户昵称或客户订单上的联系方式。在其他情况下，数据可能来自其他不受信任的来源；例如，显示通过SMTP接收的消息的Webmail应用程序，显示社交媒体帖子的营销应用程序或显示来自网络流量的数据包数据的网络监视应用程序。

假设一个网站允许用户提交有关博客文章的评论，这些评论将显示给其他用户。用户使用HTTP请求提交评论，如下所示：
```text
POST /post/comment HTTP/1.1
Host: vulnerable-website.com
Content-Length: 100

postId=3&comment=This+post+was+extremely+helpful.&name=Carlos+Montoya&email=carlos%40normal-user.net
```
提交此评论后，任何访问博客文章的用户都将在应用程序的响应中收到以下内容：

`<p>This post was extremely helpful.</p>`

假设应用程序不执行任何其他数据处理，则攻击者可以提交如下恶意评论：

`<script>/* Bad stuff here... */</script>`
在攻击者的请求内，此注释将被URL编码为：

`comment=%3Cscript%3E%2F*%2BBad%2Bstuff%2Bhere...%2B*%2F%3C%2Fscript%3E`

现在，访问博客文章的任何用户都将在应用程序的响应中收到以下内容：

`<p><script>/* Bad stuff here... */</script></p>`

然后，攻击者提供的脚本将在受害用户与应用程序会话的上下文中在受害用户的浏览器中执行。




### 在不同情况下的反射型XSS
反映的跨站点脚本有许多不同的种类。反射数据在应用程序响应中的位置决定了使用哪种有效负载类型，也可能影响漏洞的影响。

另外，如果应用程序在反映提交的数据之前对其进行了任何验证或其他处理，则通常会影响所需的XSS有效负载类型。


### 反射型XSS攻击的影响

如果攻击者可以控制在受害者浏览器中执行的脚本，那么他们通常可以完全破坏该用户。除其他外，攻击者可以：

* 在用户可以执行的应用程序中执行任何操作。
* 查看用户能够查看的任何信息。
* 修改用户能够修改的任何信息。
* 启动与其他应用程序用户的交互，包括恶意攻击，这些交互似乎源自最初的受害者用户。

攻击者可以通过多种方式诱使受害用户发出由他们控制的请求，以传递反射的XSS攻击。其中包括在攻击者控制的网站上放置链接，或在允许生成内容的其他网站上放置链接，或者通过在电子邮件，推文或其他消息中发送链接来放置链接。攻击可能直接针对已知用户，也可能是针对应用程序的任何用户的不加选择的攻击： 对于攻击的外部传递机制的需求意味着，反射的XSS的影响通常不如存储的XSS严重，存储的XSS可以在易受攻击的应用程序内部传递独立的攻击。


### 利用跨站点脚本漏洞
证明已发现跨站点脚本漏洞的传统方法是使用alert()功能创建弹出窗口，不是因为XSS与弹出窗口有关，只是证明可以在给定域上执行任意JavaScript的一种方式。也有人在使用`alert(document.domain)`这是一种使JavaScript明确在哪个域上执行的方法。

有时，可能会想更进一步，通过提供完整的利用来证明XSS漏洞是真正的威胁。将探讨三种最流行和最强大的利用XSS漏洞的方法。

### 利用跨站点脚本窃取cookie

窃取cookie是利用XSS的传统方法。大多数Web应用程序使用cookie进行会话处理。您可以利用跨站点脚本漏洞将受害者的cookie发送到您自己的域，然后手动将cookie注入浏览器并模拟受害者。

实际上，此方法有一些重大限制：

* 受害者可能未登录。
* 许多应用程序使用该HttpOnly标志从JavaScript隐藏其cookie 。
* 会话可能被锁定到其他因素，例如用户的IP地址。
* 在可以劫持会话之前，会话可能会超时。

### 利用跨站点脚本捕获密码

如今，许多用户都使用了密码管理器来自动填写密码。可以通过创建密码输入，读取自动填充的密码并将其发送到您自己的域来利用此优势。此技术避免了大多数与窃取Cookie有关的问题，甚至可以访问受害人重复使用相同密码的每个其他帐户。

此技术的主要缺点是，它仅适用于具有执行密码自动填充的密码管理器的用户。（当然，如果用户没有保存密码，仍然可以尝试通过现场网络钓鱼攻击来获取其密码）

### 利用跨站点脚本执行CSRF

某些网站允许登录用户更改其电子邮件地址，而无需重新输入密码。如果发现了XSS漏洞，则可以使其触发此功能，以将受害者的电子邮件地址更改为您控制的电子邮件地址，然后触发密码重置以访问该帐户。

这种类型的利用通常称为跨站点请求伪造（CSRF），这有点令人困惑，因为CSRF也可能作为独立漏洞发生。当CSRF作为独立漏洞出现时，可以使用反CSRF令牌等策略对其进行修补。但是，如果还存在XSS漏洞，则这些策略不能提供任何保护。
